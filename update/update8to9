#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Update from version 8 to version 9 of Yokadi DB

- Delete invalid TaskKeyword rows

@author: Aurélien Gâteau <mail@agateau.com>
@license: GPL v3 or newer
"""
import sys

from sqlalchemy import create_engine


def deleteInvalidTaskKeywordRows(conn):
    conn.execute('delete from task_keyword where task_id is null or keyword_id is null')


def main():
    uri = 'sqlite:///' + sys.argv[1]
    engine = create_engine(uri)
    with engine.begin() as conn:
        deleteInvalidTaskKeywordRows(conn)


if __name__ == "__main__":
    main()
# vi: ts=4 sw=4 et
